# .env.production - Environment Variables for Render.com Deployment
# IMPORTANT: Do NOT commit this file to git!
# Copy this file and add your actual values in the Render dashboard

# =============================================================================
# API KEYS (Required - Add these in Render Dashboard, not here!)
# =============================================================================
# Get your keys from:
# - OpenRouter: https://openrouter.ai/settings/keys
# - Voyage AI: https://www.voyageai.com/
OPENROUTER_API_KEY=your_openrouter_api_key_here
VOYAGE_API_KEY=your_voyage_api_key_here

# =============================================================================
# DATABASE - Supabase (External Service)
# =============================================================================
# Get your connection string from Supabase Dashboard → Settings → Database
# Select "Connection String" → "URI" format and add +asyncpg after postgresql:
#
# Example format:
# postgresql+asyncpg://postgres:[password]@db.[project-ref].supabase.co:5432/postgres
DATABASE_URL=postgresql+asyncpg://postgres:YOUR_PASSWORD@db.YOUR_PROJECT_REF.supabase.co:5432/postgres
#
# IMPORTANT: Replace with your actual Supabase connection string!

# =============================================================================
# REDIS - Upstash (External Service)
# =============================================================================
# Get your Redis URL from Upstash Dashboard → REST API → Redis REST URL
# Convert REST URL to Redis URL by replacing 'https' with 'redis' and 'rest' with 'default'
#
# Example format:
# redis://default:[password]@your-redis-url.upstash.io:6379
REDIS_URL=redis://default:YOUR_PASSWORD@YOUR_REDIS.upstash.io:6379
#
# IMPORTANT: Replace with your actual Upstash Redis URL!

# =============================================================================
# APPLICATION SETTINGS
# =============================================================================
APP_NAME=OpenTA API
APP_VERSION=1.0.0
APP_DESCRIPTION=AI-powered paper research platform for Telkom University
DEBUG=false
HOST=0.0.0.0
PORT=8000

# =============================================================================
# DSPy / LLM CONFIGURATION
# =============================================================================
# Main model for answer generation
DSPY_MODEL=openrouter/google/gemini-2.5-pro-preview

# Cheap model for query generation, intent classification
DSPY_CHEAP_MODEL=openrouter/openai/gpt-4o-mini

# Number of async workers for DSPy
DSPY_MAX_WORKERS=4

# OpenRouter base URL
OPENROUTER_BASE_URL=https://openrouter.ai/api/v1

# =============================================================================
# RETRIEVAL CONFIGURATION
# =============================================================================
# Number of papers to retrieve per query
RETRIEVAL_TOP_K=3

# Embedding model for vector search
EMBEDDING_MODEL=voyage-4-lite

# Embedding dimensions (must match model)
EMBEDDING_DIM=1024

# =============================================================================
# DATABASE POOL SETTINGS
# =============================================================================
# Connection pool size for async database
DB_POOL_SIZE=5
DB_MAX_OVERFLOW=10
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=1800

# =============================================================================
# SESSION CONFIGURATION (Redis)
# =============================================================================
# Session TTL in seconds (default: 1 hour = 3600)
SESSION_TTL=3600

# Maximum messages to keep per session
MAX_MESSAGES_PER_SESSION=50

# Auto-sync to database (requires DATABASE_URL)
AUTO_SYNC_TO_DB=true

# Sync interval in seconds (5 minutes)
SYNC_INTERVAL=300

# =============================================================================
# CORS SETTINGS
# =============================================================================
# Comma-separated list of allowed origins
# Update with your frontend URL
CORS_ORIGINS_STR=https://openta-frontend.onrender.com,https://your-custom-domain.com

# =============================================================================
# OPTIONAL: MONITORING & LOGGING
# =============================================================================
# Sentry DSN for error tracking (optional)
# SENTRY_DSN=https://xxx@sentry.io/xxx

# Log level (DEBUG, INFO, WARNING, ERROR, CRITICAL)
# LOG_LEVEL=INFO

# =============================================================================
# OPTIONAL: ADMIN / SECURITY
# =============================================================================
# Admin key for migration endpoints
# RENDER_ADMIN_KEY=your_secure_random_key_here

# Enable rate limiting (future feature)
# ENABLE_RATE_LIMITING=true

# =============================================================================
# NOTES
# =============================================================================
# 1. DO NOT commit actual API keys or passwords
# 2. Set sensitive values in Render Dashboard: https://dashboard.render.com
# 3. You must have your own Supabase and Upstash accounts
# 4. Update CORS_ORIGINS_STR with your actual frontend URL
#
# EXTERNAL SERVICES REQUIRED:
# - Supabase: https://supabase.com (PostgreSQL + pgvector)
# - Upstash: https://upstash.com (Redis for conversation history)
